(self.webpackChunk_niivue_docs=self.webpackChunk_niivue_docs||[]).push([[997],{333:(t,e,i)=>{"use strict";i.d(e,{Bw:()=>a,S8:()=>o,fA:()=>s,hs:()=>r});var n=i(3172);function s(t,e){var i=new n.tb(2);return i[0]=t,i[1]=e,i}function r(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function a(t){var e=t[0],i=t[1];return Math.hypot(e,i)}function o(t,e){var i=e[0],n=e[1],s=i*i+n*n;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t}var h,l;h=new n.tb(2),n.tb!=Float32Array&&(h[0]=0,h[1]=0),l=h},911:(t,e,i)=>{"use strict";i.d(e,{WQ:()=>o,Z0:()=>l,fA:()=>a,hs:()=>h,jb:()=>c,o8:()=>r,vt:()=>s});var n=i(3172);function s(){var t=new n.tb(4);return n.tb!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function r(t){var e=new n.tb(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function a(t,e,i,s){var r=new n.tb(4);return r[0]=t,r[1]=e,r[2]=i,r[3]=s,r}function o(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t}function h(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}function l(t,e,i){var n=e[0],s=e[1],r=e[2],a=e[3];return t[0]=i[0]*n+i[4]*s+i[8]*r+i[12]*a,t[1]=i[1]*n+i[5]*s+i[9]*r+i[13]*a,t[2]=i[2]*n+i[6]*s+i[10]*r+i[14]*a,t[3]=i[3]*n+i[7]*s+i[11]*r+i[15]*a,t}var f,c=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t};f=s()},2651:(t,e,i)=>{"use strict";i.d(e,{i:()=>r});var n=i(8553);const s="object"==typeof self?self:globalThis,r=t=>((t,e)=>{const i=(e,i)=>(t.set(i,e),e),r=a=>{if(t.has(a))return t.get(a);const[o,h]=e[a];switch(o){case n.uT:case n.tV:return i(h,a);case n.sO:{const t=i([],a);for(const e of h)t.push(r(e));return t}case n.qv:{const t=i({},a);for(const[e,i]of h)t[r(e)]=r(i);return t}case n.vH:return i(new Date(h),a);case n.Wm:{const{source:t,flags:e}=h;return i(new RegExp(t,e),a)}case n.lC:{const t=i(new Map,a);for(const[e,i]of h)t.set(r(e),r(i));return t}case n.rK:{const t=i(new Set,a);for(const e of h)t.add(r(e));return t}case n.ff:{const{name:t,message:e}=h;return i(new s[t](e),a)}case n.Ei:return i(BigInt(h),a);case"BigInt":return i(Object(BigInt(h)),a);case"ArrayBuffer":return i(new Uint8Array(h).buffer,h);case"DataView":{const{buffer:t}=new Uint8Array(h);return i(new DataView(t),h)}}return i(new s[o](h),a)};return r})(new Map,t)(0)},2859:(t,e,i)=>{"use strict";i.d(e,{a:()=>s});var n=i(5976);class s{littleEndian=!1;dim_info=0;dims=[];intent_p1=0;intent_p2=0;intent_p3=0;intent_code=0;datatypeCode=0;numBitsPerVoxel=0;slice_start=0;slice_end=0;slice_code=0;pixDims=[];vox_offset=0;scl_slope=1;scl_inter=0;xyzt_units=0;cal_max=0;cal_min=0;slice_duration=0;toffset=0;description="";aux_file="";intent_name="";qform_code=0;sform_code=0;quatern_a=0;quatern_b=0;quatern_c=0;quatern_d=0;qoffset_x=0;qoffset_y=0;qoffset_z=0;affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];qfac=1;quatern_R;magic="0";isHDR=!1;extensionFlag=[0,0,0,0];extensionSize=0;extensionCode=0;extensions=[];static TYPE_NONE=0;static TYPE_BINARY=1;static TYPE_UINT8=2;static TYPE_INT16=4;static TYPE_INT32=8;static TYPE_FLOAT32=16;static TYPE_COMPLEX64=32;static TYPE_FLOAT64=64;static TYPE_RGB24=128;static TYPE_INT8=256;static TYPE_UINT16=512;static TYPE_UINT32=768;static TYPE_INT64=1024;static TYPE_UINT64=1280;static TYPE_FLOAT128=1536;static TYPE_COMPLEX128=1792;static TYPE_COMPLEX256=2048;static XFORM_UNKNOWN=0;static XFORM_SCANNER_ANAT=1;static XFORM_ALIGNED_ANAT=2;static XFORM_TALAIRACH=3;static XFORM_MNI_152=4;static SPATIAL_UNITS_MASK=7;static TEMPORAL_UNITS_MASK=56;static UNITS_UNKNOWN=0;static UNITS_METER=1;static UNITS_MM=2;static UNITS_MICRON=3;static UNITS_SEC=8;static UNITS_MSEC=16;static UNITS_USEC=24;static UNITS_HZ=32;static UNITS_PPM=40;static UNITS_RADS=48;static MAGIC_COOKIE=348;static STANDARD_HEADER_SIZE=348;static MAGIC_NUMBER_LOCATION=344;static MAGIC_NUMBER=[110,43,49];static MAGIC_NUMBER2=[110,105,49];static EXTENSION_HEADER_SIZE=8;readHeader(t){var e,i,r,a,o=new DataView(t),h=n.A.getIntAt(o,0,this.littleEndian);if(h!==s.MAGIC_COOKIE&&(this.littleEndian=!0,h=n.A.getIntAt(o,0,this.littleEndian)),h!==s.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.dim_info=n.A.getByteAt(o,39),e=0;e<8;e+=1)a=40+2*e,this.dims[e]=n.A.getShortAt(o,a,this.littleEndian);for(this.intent_p1=n.A.getFloatAt(o,56,this.littleEndian),this.intent_p2=n.A.getFloatAt(o,60,this.littleEndian),this.intent_p3=n.A.getFloatAt(o,64,this.littleEndian),this.intent_code=n.A.getShortAt(o,68,this.littleEndian),this.datatypeCode=n.A.getShortAt(o,70,this.littleEndian),this.numBitsPerVoxel=n.A.getShortAt(o,72,this.littleEndian),this.slice_start=n.A.getShortAt(o,74,this.littleEndian),e=0;e<8;e+=1)a=76+4*e,this.pixDims[e]=n.A.getFloatAt(o,a,this.littleEndian);if(this.vox_offset=n.A.getFloatAt(o,108,this.littleEndian),this.scl_slope=n.A.getFloatAt(o,112,this.littleEndian),this.scl_inter=n.A.getFloatAt(o,116,this.littleEndian),this.slice_end=n.A.getShortAt(o,120,this.littleEndian),this.slice_code=n.A.getByteAt(o,122),this.xyzt_units=n.A.getByteAt(o,123),this.cal_max=n.A.getFloatAt(o,124,this.littleEndian),this.cal_min=n.A.getFloatAt(o,128,this.littleEndian),this.slice_duration=n.A.getFloatAt(o,132,this.littleEndian),this.toffset=n.A.getFloatAt(o,136,this.littleEndian),this.description=n.A.getStringAt(o,148,228),this.aux_file=n.A.getStringAt(o,228,252),this.qform_code=n.A.getShortAt(o,252,this.littleEndian),this.sform_code=n.A.getShortAt(o,254,this.littleEndian),this.quatern_b=n.A.getFloatAt(o,256,this.littleEndian),this.quatern_c=n.A.getFloatAt(o,260,this.littleEndian),this.quatern_d=n.A.getFloatAt(o,264,this.littleEndian),this.quatern_a=Math.sqrt(1-(Math.pow(this.quatern_b,2)+Math.pow(this.quatern_c,2)+Math.pow(this.quatern_d,2))),this.qoffset_x=n.A.getFloatAt(o,268,this.littleEndian),this.qoffset_y=n.A.getFloatAt(o,272,this.littleEndian),this.qoffset_z=n.A.getFloatAt(o,276,this.littleEndian),this.qform_code<1&&this.sform_code<1&&(this.affine[0][0]=this.pixDims[1],this.affine[1][1]=this.pixDims[2],this.affine[2][2]=this.pixDims[3]),this.qform_code>0&&this.sform_code<this.qform_code){const t=this.quatern_a,e=this.quatern_b,n=this.quatern_c,s=this.quatern_d;for(this.qfac=0===this.pixDims[0]?1:this.pixDims[0],this.quatern_R=[[t*t+e*e-n*n-s*s,2*e*n-2*t*s,2*e*s+2*t*n],[2*e*n+2*t*s,t*t+n*n-e*e-s*s,2*n*s-2*t*e],[2*e*s-2*t*n,2*n*s+2*t*e,t*t+s*s-n*n-e*e]],i=0;i<3;i+=1)for(r=0;r<3;r+=1)this.affine[i][r]=this.quatern_R[i][r]*this.pixDims[r+1],2===r&&(this.affine[i][r]*=this.qfac);this.affine[0][3]=this.qoffset_x,this.affine[1][3]=this.qoffset_y,this.affine[2][3]=this.qoffset_z}else if(this.sform_code>0)for(i=0;i<3;i+=1)for(r=0;r<4;r+=1)a=280+4*(4*i+r),this.affine[i][r]=n.A.getFloatAt(o,a,this.littleEndian);if(this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.intent_name=n.A.getStringAt(o,328,344),this.magic=n.A.getStringAt(o,344,348),this.isHDR=this.magic===String.fromCharCode.apply(null,s.MAGIC_NUMBER2),o.byteLength>s.MAGIC_COOKIE){this.extensionFlag[0]=n.A.getByteAt(o,348),this.extensionFlag[1]=n.A.getByteAt(o,349),this.extensionFlag[2]=n.A.getByteAt(o,350),this.extensionFlag[3]=n.A.getByteAt(o,351);let t=!0;!this.isHDR&&this.vox_offset<=352&&(t=!1),o.byteLength<=368&&(t=!1),t&&this.extensionFlag[0]&&(this.extensions=n.A.getExtensionsAt(o,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode)}}toFormattedString(){var t=n.A.formatNumber,e="";return e+="Dim Info = "+this.dim_info+"\n",e+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+"\n",e+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+"\n",e+="Intent Code = "+this.intent_code+"\n",e+="Datatype = "+this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+")\n",e+="Bits Per Voxel = "+this.numBitsPerVoxel+"\n",e+="Slice Start = "+this.slice_start+"\n",e+="Voxel Dimensions (1-8): "+t(this.pixDims[0])+", "+t(this.pixDims[1])+", "+t(this.pixDims[2])+", "+t(this.pixDims[3])+", "+t(this.pixDims[4])+", "+t(this.pixDims[5])+", "+t(this.pixDims[6])+", "+t(this.pixDims[7])+"\n",e+="Image Offset = "+this.vox_offset+"\n",e+="Data Scale:  Slope = "+t(this.scl_slope)+"  Intercept = "+t(this.scl_inter)+"\n",e+="Slice End = "+this.slice_end+"\n",e+="Slice Code = "+this.slice_code+"\n",e+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(s.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(s.TEMPORAL_UNITS_MASK&this.xyzt_units)+")\n",e+="Display Range:  Max = "+t(this.cal_max)+"  Min = "+t(this.cal_min)+"\n",e+="Slice Duration = "+this.slice_duration+"\n",e+="Time Axis Shift = "+this.toffset+"\n",e+='Description: "'+this.description+'"\n',e+='Auxiliary File: "'+this.aux_file+'"\n',e+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+")\n",e+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+")\n",e+="Quaternion Parameters:  b = "+t(this.quatern_b)+"  c = "+t(this.quatern_c)+"  d = "+t(this.quatern_d)+"\n",e+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+"\n",e+="S-Form Parameters X: "+t(this.affine[0][0])+", "+t(this.affine[0][1])+", "+t(this.affine[0][2])+", "+t(this.affine[0][3])+"\n",e+="S-Form Parameters Y: "+t(this.affine[1][0])+", "+t(this.affine[1][1])+", "+t(this.affine[1][2])+", "+t(this.affine[1][3])+"\n",e+="S-Form Parameters Z: "+t(this.affine[2][0])+", "+t(this.affine[2][1])+", "+t(this.affine[2][2])+", "+t(this.affine[2][3])+"\n",e+='Intent Name: "'+this.intent_name+'"\n',this.extensionFlag[0]&&(e+="Extension: Size = "+this.extensionSize+"  Code = "+this.extensionCode+"\n"),e}getDatatypeCodeString=function(t){return t===s.TYPE_UINT8?"1-Byte Unsigned Integer":t===s.TYPE_INT16?"2-Byte Signed Integer":t===s.TYPE_INT32?"4-Byte Signed Integer":t===s.TYPE_FLOAT32?"4-Byte Float":t===s.TYPE_FLOAT64?"8-Byte Float":t===s.TYPE_RGB24?"RGB":t===s.TYPE_INT8?"1-Byte Signed Integer":t===s.TYPE_UINT16?"2-Byte Unsigned Integer":t===s.TYPE_UINT32?"4-Byte Unsigned Integer":t===s.TYPE_INT64?"8-Byte Signed Integer":t===s.TYPE_UINT64?"8-Byte Unsigned Integer":"Unknown"};getTransformCodeString=function(t){return t===s.XFORM_SCANNER_ANAT?"Scanner":t===s.XFORM_ALIGNED_ANAT?"Aligned":t===s.XFORM_TALAIRACH?"Talairach":t===s.XFORM_MNI_152?"MNI":"Unknown"};getUnitsCodeString=function(t){return t===s.UNITS_METER?"Meters":t===s.UNITS_MM?"Millimeters":t===s.UNITS_MICRON?"Microns":t===s.UNITS_SEC?"Seconds":t===s.UNITS_MSEC?"Milliseconds":t===s.UNITS_USEC?"Microseconds":t===s.UNITS_HZ?"Hz":t===s.UNITS_PPM?"PPM":t===s.UNITS_RADS?"Rads":"Unknown"};getQformMat(){return this.convertNiftiQFormToNiftiSForm(this.quatern_b,this.quatern_c,this.quatern_d,this.qoffset_x,this.qoffset_y,this.qoffset_z,this.pixDims[1],this.pixDims[2],this.pixDims[3],this.pixDims[0])}convertNiftiQFormToNiftiSForm(t,e,i,n,s,r,a,o,h,l){var f,c,u,d,_=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],A=t,g=e,E=i;return _[3][0]=_[3][1]=_[3][2]=0,_[3][3]=1,(f=1-(A*A+g*g+E*E))<1e-7?(A*=f=1/Math.sqrt(A*A+g*g+E*E),g*=f,E*=f,f=0):f=Math.sqrt(f),c=a>0?a:1,u=o>0?o:1,d=h>0?h:1,l<0&&(d=-d),_[0][0]=(f*f+A*A-g*g-E*E)*c,_[0][1]=2*(A*g-f*E)*u,_[0][2]=2*(A*E+f*g)*d,_[1][0]=2*(A*g+f*E)*c,_[1][1]=(f*f+g*g-A*A-E*E)*u,_[1][2]=2*(g*E-f*A)*d,_[2][0]=2*(A*E-f*g)*c,_[2][1]=2*(g*E+f*A)*u,_[2][2]=(f*f+E*E-g*g-A*A)*d,_[0][3]=n,_[1][3]=s,_[2][3]=r,_}convertNiftiSFormToNEMA(t){var e,i,n,s,r,a,o,h,l,f,c,u,d,_,A,g,E,m,p,I,x,y,v,b,M,S,T,w,C,N,F,U,q;if(_=0,S=[[0,0,0],[0,0,0],[0,0,0]],T=[[0,0,0],[0,0,0],[0,0,0]],e=t[0][0],i=t[0][1],n=t[0][2],s=t[1][0],r=t[1][1],a=t[1][2],o=t[2][0],h=t[2][1],l=t[2][2],0===(f=Math.sqrt(e*e+s*s+o*o)))return null;if(e/=f,s/=f,o/=f,0===(f=Math.sqrt(i*i+r*r+h*h)))return null;if(f=e*(i/=f)+s*(r/=f)+o*(h/=f),Math.abs(f)>1e-4){if(i-=f*e,r-=f*s,h-=f*o,0===(f=Math.sqrt(i*i+r*r+h*h)))return null;i/=f,r/=f,h/=f}if(0===(f=Math.sqrt(n*n+a*a+l*l))?(n=s*h-o*r,a=o*i-h*e,l=e*r-s*i):(n/=f,a/=f,l/=f),f=e*n+s*a+o*l,Math.abs(f)>1e-4){if(n-=f*e,a-=f*s,l-=f*o,0===(f=Math.sqrt(n*n+a*a+l*l)))return null;n/=f,a/=f,l/=f}if(f=i*n+r*a+h*l,Math.abs(f)>1e-4){if(n-=f*i,a-=f*r,l-=f*h,0===(f=Math.sqrt(n*n+a*a+l*l)))return null;n/=f,a/=f,l/=f}if(S[0][0]=e,S[0][1]=i,S[0][2]=n,S[1][0]=s,S[1][1]=r,S[1][2]=a,S[2][0]=o,S[2][1]=h,S[2][2]=l,0===(c=this.nifti_mat33_determ(S)))return null;for(M=-666,m=x=y=v=1,p=2,I=3,u=1;u<=3;u+=1)for(d=1;d<=3;d+=1)if(u!==d)for(_=1;_<=3;_+=1)if(u!==_&&d!==_)for(T[0][0]=T[0][1]=T[0][2]=T[1][0]=T[1][1]=T[1][2]=T[2][0]=T[2][1]=T[2][2]=0,A=-1;A<=1;A+=2)for(g=-1;g<=1;g+=2)for(E=-1;E<=1;E+=2)T[0][u-1]=A,T[1][d-1]=g,T[2][_-1]=E,this.nifti_mat33_determ(T)*c>0&&(f=(b=this.nifti_mat33_mul(T,S))[0][0]+b[1][1]+b[2][2])>M&&(M=f,m=u,p=d,I=_,x=A,y=g,v=E);switch(w=C=N=F=U=q="",m*x){case 1:w="X",F="+";break;case-1:w="X",F="-";break;case 2:w="Y",F="+";break;case-2:w="Y",F="-";break;case 3:w="Z",F="+";break;case-3:w="Z",F="-"}switch(p*y){case 1:C="X",U="+";break;case-1:C="X",U="-";break;case 2:C="Y",U="+";break;case-2:C="Y",U="-";break;case 3:C="Z",U="+";break;case-3:C="Z",U="-"}switch(I*v){case 1:N="X",q="+";break;case-1:N="X",q="-";break;case 2:N="Y",q="+";break;case-2:N="Y",q="-";break;case 3:N="Z",q="+";break;case-3:N="Z",q="-"}return w+C+N+F+U+q}nifti_mat33_mul=function(t,e){var i,n,s=[[0,0,0],[0,0,0],[0,0,0]];for(i=0;i<3;i+=1)for(n=0;n<3;n+=1)s[i][n]=t[i][0]*e[0][n]+t[i][1]*e[1][n]+t[i][2]*e[2][n];return s};nifti_mat33_determ=function(t){var e,i,n,s,r,a,o,h,l;return e=t[0][0],i=t[0][1],n=t[0][2],s=t[1][0],r=t[1][1],a=t[1][2],o=t[2][0],h=t[2][1],e*r*(l=t[2][2])-e*h*a-s*i*l+s*h*n+o*i*a-o*r*n};getExtensionLocation(){return s.MAGIC_COOKIE+4}getExtensionSize(t){return n.A.getIntAt(t,this.getExtensionLocation(),this.littleEndian)}getExtensionCode(t){return n.A.getIntAt(t,this.getExtensionLocation()+4,this.littleEndian)}addExtension(t,e=-1){-1==e?this.extensions.push(t):this.extensions.splice(e,0,t),this.vox_offset+=t.esize}removeExtension(t){let e=this.extensions[t];e&&(this.vox_offset-=e.esize),this.extensions.splice(t,1)}toArrayBuffer(t=!1){let e=352;if(t)for(let r of this.extensions)e+=r.esize;let i=new Uint8Array(e),n=new DataView(i.buffer);n.setInt32(0,348,this.littleEndian),n.setUint8(39,this.dim_info);for(let r=0;r<8;r++)n.setUint16(40+2*r,this.dims[r],this.littleEndian);n.setFloat32(56,this.intent_p1,this.littleEndian),n.setFloat32(60,this.intent_p2,this.littleEndian),n.setFloat32(64,this.intent_p3,this.littleEndian),n.setInt16(68,this.intent_code,this.littleEndian),n.setInt16(70,this.datatypeCode,this.littleEndian),n.setInt16(72,this.numBitsPerVoxel,this.littleEndian),n.setInt16(74,this.slice_start,this.littleEndian);for(let r=0;r<8;r++)n.setFloat32(76+4*r,this.pixDims[r],this.littleEndian);n.setFloat32(108,this.vox_offset,this.littleEndian),n.setFloat32(112,this.scl_slope,this.littleEndian),n.setFloat32(116,this.scl_inter,this.littleEndian),n.setInt16(120,this.slice_end,this.littleEndian),n.setUint8(122,this.slice_code),n.setUint8(123,this.xyzt_units),n.setFloat32(124,this.cal_max,this.littleEndian),n.setFloat32(128,this.cal_min,this.littleEndian),n.setFloat32(132,this.slice_duration,this.littleEndian),n.setFloat32(136,this.toffset,this.littleEndian),i.set((new TextEncoder).encode(this.description),148),i.set((new TextEncoder).encode(this.aux_file),228),n.setInt16(252,this.qform_code,this.littleEndian),n.setInt16(254,this.sform_code,this.littleEndian),n.setFloat32(256,this.quatern_b,this.littleEndian),n.setFloat32(260,this.quatern_c,this.littleEndian),n.setFloat32(264,this.quatern_d,this.littleEndian),n.setFloat32(268,this.qoffset_x,this.littleEndian),n.setFloat32(272,this.qoffset_y,this.littleEndian),n.setFloat32(276,this.qoffset_z,this.littleEndian);const s=this.affine.flat();for(let r=0;r<12;r++)n.setFloat32(280+4*r,s[r],this.littleEndian);if(i.set((new TextEncoder).encode(this.intent_name),328),i.set((new TextEncoder).encode(this.magic),344),t){i.set(Uint8Array.from([1,0,0,0]),348);let t=this.getExtensionLocation();for(const e of this.extensions)n.setInt32(t,e.esize,e.littleEndian),n.setInt32(t+4,e.ecode,e.littleEndian),i.set(new Uint8Array(e.edata),t+8),t+=e.esize}else i.set(new Uint8Array(4).fill(0),348);return i.buffer}}},3172:(t,e,i)=>{"use strict";i.d(e,{p8:()=>n,tb:()=>s});var n=1e-6,s="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},4062:(t,e,i)=>{"use strict";i.d(e,{$A:()=>g,Bw:()=>a,C:()=>h,Cc:()=>E,Il:()=>x,Re:()=>f,S8:()=>A,T9:()=>u,WQ:()=>l,fA:()=>o,g7:()=>m,hs:()=>d,jb:()=>I,jk:()=>c,o8:()=>r,vt:()=>s,ze:()=>_});var n=i(3172);function s(){var t=new n.tb(3);return n.tb!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function r(t){var e=new n.tb(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function a(t){var e=t[0],i=t[1],n=t[2];return Math.hypot(e,i,n)}function o(t,e,i){var s=new n.tb(3);return s[0]=t,s[1]=e,s[2]=i,s}function h(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function l(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function f(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function c(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t}function u(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t}function d(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function _(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function A(t,e){var i=e[0],n=e[1],s=e[2],r=i*i+n*n+s*s;return r>0&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function g(t,e,i){var n=e[0],s=e[1],r=e[2],a=i[0],o=i[1],h=i[2];return t[0]=s*h-r*o,t[1]=r*a-n*h,t[2]=n*o-s*a,t}function E(t,e,i,n){var s=e[0],r=e[1],a=e[2];return t[0]=s+n*(i[0]-s),t[1]=r+n*(i[1]-r),t[2]=a+n*(i[2]-a),t}function m(t,e){var i=t[0],n=t[1],s=t[2],r=e[0],a=e[1],o=e[2],h=Math.sqrt(i*i+n*n+s*s)*Math.sqrt(r*r+a*a+o*o),l=h&&function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}(t,e)/h;return Math.acos(Math.min(Math.max(l,-1),1))}var p,I=f,x=a;p=s()},4990:(t,e,i)=>{"use strict";i.d(e,{s:()=>n});class n{esize;ecode;edata;littleEndian;constructor(t,e,i,n){if(t%16!=0)throw new Error("This does not appear to be a NIFTI extension");this.esize=t,this.ecode=e,this.edata=i,this.littleEndian=n}toArrayBuffer(){let t=new Uint8Array(this.esize),e=new Uint8Array(this.edata);t.set(e,8);let i=new DataView(t.buffer);return i.setInt32(0,this.esize,this.littleEndian),i.setInt32(4,this.ecode,this.littleEndian),t.buffer}}},5798:(t,e,i)=>{"use strict";i.d(e,{l:()=>l});var n=i(8553);const s="",{toString:r}={},{keys:a}=Object,o=t=>{const e=typeof t;if("object"!==e||!t)return[n.uT,e];const i=r.call(t).slice(8,-1);switch(i){case"Array":return[n.sO,s];case"Object":return[n.qv,s];case"Date":return[n.vH,s];case"RegExp":return[n.Wm,s];case"Map":return[n.lC,s];case"Set":return[n.rK,s];case"DataView":return[n.sO,i]}return i.includes("Array")?[n.sO,i]:i.includes("Error")?[n.ff,i]:[n.qv,i]},h=([t,e])=>t===n.uT&&("function"===e||"symbol"===e),l=(t,{json:e,lossy:i}={})=>{const s=[];return((t,e,i,s)=>{const r=(t,e)=>{const n=s.push(t)-1;return i.set(e,n),n},l=s=>{if(i.has(s))return i.get(s);let[f,c]=o(s);switch(f){case n.uT:{let e=s;switch(c){case"bigint":f=n.Ei,e=s.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+c);e=null;break;case"undefined":return r([n.tV],s)}return r([f,e],s)}case n.sO:{if(c){let t=s;return"DataView"===c?t=new Uint8Array(s.buffer):"ArrayBuffer"===c&&(t=new Uint8Array(s)),r([c,[...t]],s)}const t=[],e=r([f,t],s);for(const i of s)t.push(l(i));return e}case n.qv:{if(c)switch(c){case"BigInt":return r([c,s.toString()],s);case"Boolean":case"Number":case"String":return r([c,s.valueOf()],s)}if(e&&"toJSON"in s)return l(s.toJSON());const i=[],n=r([f,i],s);for(const e of a(s))!t&&h(o(s[e]))||i.push([l(e),l(s[e])]);return n}case n.vH:return r([f,s.toISOString()],s);case n.Wm:{const{source:t,flags:e}=s;return r([f,{source:t,flags:e}],s)}case n.lC:{const e=[],i=r([f,e],s);for(const[n,r]of s)(t||!h(o(n))&&!h(o(r)))&&e.push([l(n),l(r)]);return i}case n.rK:{const e=[],i=r([f,e],s);for(const n of s)!t&&h(o(n))||e.push(l(n));return i}}const{message:u}=s;return r([f,{name:c,message:u}],s)};return l})(!(e||i),!!e,new Map,s)(t),s}},5806:t=>{t.exports=function(t,e){var i=t.length;if(t===e)return!0;if(i!==e.length)return!1;for(var n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}},5878:(t,e,i)=>{"use strict";i.d(e,{fA:()=>r,lw:()=>a,vt:()=>s});var n=i(3172);function s(){var t=new n.tb(9);return n.tb!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function r(t,e,i,s,r,a,o,h,l){var f=new n.tb(9);return f[0]=t,f[1]=e,f[2]=i,f[3]=s,f[4]=r,f[5]=a,f[6]=o,f[7]=h,f[8]=l,f}function a(t,e,i){var n=e[0],s=e[1],r=e[2],a=e[3],o=e[4],h=e[5],l=e[6],f=e[7],c=e[8],u=i[0],d=i[1],_=i[2],A=i[3],g=i[4],E=i[5],m=i[6],p=i[7],I=i[8];return t[0]=u*n+d*a+_*l,t[1]=u*s+d*o+_*f,t[2]=u*r+d*h+_*c,t[3]=A*n+g*a+E*l,t[4]=A*s+g*o+E*f,t[5]=A*r+g*h+E*c,t[6]=m*n+p*a+I*l,t[7]=m*s+p*o+I*f,t[8]=m*r+p*h+I*c,t}},5976:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var n=i(4990);class s{static crcTable=null;static GUNZIP_MAGIC_COOKIE1=31;static GUNZIP_MAGIC_COOKIE2=139;static getStringAt(t,e,i){var n,s,r="";for(n=e;n<i;n+=1)0!==(s=t.getUint8(n))&&(r+=String.fromCharCode(s));return r}static getByteAt=function(t,e){return t.getUint8(e)};static getShortAt=function(t,e,i){return t.getInt16(e,i)};static getIntAt(t,e,i){return t.getInt32(e,i)}static getFloatAt(t,e,i){return t.getFloat32(e,i)}static getDoubleAt(t,e,i){return t.getFloat64(e,i)}static getInt64At(t,e,i){const n=t.getUint32(e,i),s=t.getInt32(e+4,i);let r;return r=i?s*2**32+n:n*2**32+s,s<0&&(r+=-1*2**32*2**32),r}static getUint64At(t,e,i){const n=t.getUint32(e+(i?0:4),i),s=t.getUint32(e+(i?4:0),i);return i?s*2**32+n:n*2**32+s}static getExtensionsAt(t,e,i,r){let a=[],o=e;for(;o<r;){let e=i,h=s.getIntAt(t,o,i);if(!h)break;if(h+o>r&&(e=!e,h=s.getIntAt(t,o,e),h+o>r))throw new Error("This does not appear to be a valid NIFTI extension");if(h%16!=0)throw new Error("This does not appear to be a NIFTI extension");let l=s.getIntAt(t,o+4,e),f=t.buffer.slice(o+8,o+h),c=new n.s(h,l,f,e);a.push(c),o+=h}return a}static toArrayBuffer(t){var e,i,n;for(e=new ArrayBuffer(t.length),i=new Uint8Array(e),n=0;n<t.length;n+=1)i[n]=t[n];return e}static isString(t){return"string"==typeof t||t instanceof String}static formatNumber(t,e=void 0){let i;return i=s.isString(t)?Number(t):t,i=e?i.toPrecision(5):i.toPrecision(7),parseFloat(i)}static makeCRCTable(){let t,e=[];for(var i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e}static crc32(t){s.crcTable||(s.crcTable=s.makeCRCTable());const e=s.crcTable;let i=~0;for(var n=0;n<t.byteLength;n++)i=i>>>8^e[255&(i^t.getUint8(n))];return~i>>>0}}},7565:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});i(4041);var n=i(1310),s=i(1085);function r(t){let{children:e,fallback:i}=t;return(0,n.A)()?(0,s.jsx)(s.Fragment,{children:e?.()}):i??null}},8044:(t,e,i)=>{"use strict";i.d(e,{Sz:()=>f,cx:()=>l,Ad:()=>d,AM:()=>_});var n=i(9302),s=i(2859),r=i(5976);class a{littleEndian=!1;dim_info=0;dims=[];intent_p1=0;intent_p2=0;intent_p3=0;intent_code=0;datatypeCode=0;numBitsPerVoxel=0;slice_start=0;slice_end=0;slice_code=0;pixDims=[];vox_offset=0;scl_slope=1;scl_inter=0;xyzt_units=0;cal_max=0;cal_min=0;slice_duration=0;toffset=0;description="";aux_file="";intent_name="";qform_code=0;sform_code=0;quatern_b=0;quatern_c=0;quatern_d=0;qoffset_x=0;qoffset_y=0;qoffset_z=0;affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];magic="0";extensionFlag=[0,0,0,0];extensions=[];extensionSize=0;extensionCode=0;static MAGIC_COOKIE=540;static MAGIC_NUMBER_LOCATION=4;static MAGIC_NUMBER=[110,43,50,0,13,10,26,10];static MAGIC_NUMBER2=[110,105,50,0,13,10,26,10];readHeader(t){var e,i,n,s,o=new DataView(t),h=r.A.getIntAt(o,0,this.littleEndian);if(h!==a.MAGIC_COOKIE&&(this.littleEndian=!0,h=r.A.getIntAt(o,0,this.littleEndian)),h!==a.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.magic=r.A.getStringAt(o,4,12),this.datatypeCode=r.A.getShortAt(o,12,this.littleEndian),this.numBitsPerVoxel=r.A.getShortAt(o,14,this.littleEndian),e=0;e<8;e+=1)s=16+8*e,this.dims[e]=r.A.getInt64At(o,s,this.littleEndian);for(this.intent_p1=r.A.getDoubleAt(o,80,this.littleEndian),this.intent_p2=r.A.getDoubleAt(o,88,this.littleEndian),this.intent_p3=r.A.getDoubleAt(o,96,this.littleEndian),e=0;e<8;e+=1)s=104+8*e,this.pixDims[e]=r.A.getDoubleAt(o,s,this.littleEndian);for(this.vox_offset=r.A.getInt64At(o,168,this.littleEndian),this.scl_slope=r.A.getDoubleAt(o,176,this.littleEndian),this.scl_inter=r.A.getDoubleAt(o,184,this.littleEndian),this.cal_max=r.A.getDoubleAt(o,192,this.littleEndian),this.cal_min=r.A.getDoubleAt(o,200,this.littleEndian),this.slice_duration=r.A.getDoubleAt(o,208,this.littleEndian),this.toffset=r.A.getDoubleAt(o,216,this.littleEndian),this.slice_start=r.A.getInt64At(o,224,this.littleEndian),this.slice_end=r.A.getInt64At(o,232,this.littleEndian),this.description=r.A.getStringAt(o,240,320),this.aux_file=r.A.getStringAt(o,320,344),this.qform_code=r.A.getIntAt(o,344,this.littleEndian),this.sform_code=r.A.getIntAt(o,348,this.littleEndian),this.quatern_b=r.A.getDoubleAt(o,352,this.littleEndian),this.quatern_c=r.A.getDoubleAt(o,360,this.littleEndian),this.quatern_d=r.A.getDoubleAt(o,368,this.littleEndian),this.qoffset_x=r.A.getDoubleAt(o,376,this.littleEndian),this.qoffset_y=r.A.getDoubleAt(o,384,this.littleEndian),this.qoffset_z=r.A.getDoubleAt(o,392,this.littleEndian),i=0;i<3;i+=1)for(n=0;n<4;n+=1)s=400+8*(4*i+n),this.affine[i][n]=r.A.getDoubleAt(o,s,this.littleEndian);this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.slice_code=r.A.getIntAt(o,496,this.littleEndian),this.xyzt_units=r.A.getIntAt(o,500,this.littleEndian),this.intent_code=r.A.getIntAt(o,504,this.littleEndian),this.intent_name=r.A.getStringAt(o,508,524),this.dim_info=r.A.getByteAt(o,524),o.byteLength>a.MAGIC_COOKIE&&(this.extensionFlag[0]=r.A.getByteAt(o,540),this.extensionFlag[1]=r.A.getByteAt(o,541),this.extensionFlag[2]=r.A.getByteAt(o,542),this.extensionFlag[3]=r.A.getByteAt(o,543),this.extensionFlag[0]&&(this.extensions=r.A.getExtensionsAt(o,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode))}toFormattedString(){var t=r.A.formatNumber,e="";return e+="Datatype = "+ +this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+")\n",e+="Bits Per Voxel =  = "+this.numBitsPerVoxel+"\n",e+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+"\n",e+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+"\n",e+="Voxel Dimensions (1-8): "+t(this.pixDims[0])+", "+t(this.pixDims[1])+", "+t(this.pixDims[2])+", "+t(this.pixDims[3])+", "+t(this.pixDims[4])+", "+t(this.pixDims[5])+", "+t(this.pixDims[6])+", "+t(this.pixDims[7])+"\n",e+="Image Offset = "+this.vox_offset+"\n",e+="Data Scale:  Slope = "+t(this.scl_slope)+"  Intercept = "+t(this.scl_inter)+"\n",e+="Display Range:  Max = "+t(this.cal_max)+"  Min = "+t(this.cal_min)+"\n",e+="Slice Duration = "+this.slice_duration+"\n",e+="Time Axis Shift = "+this.toffset+"\n",e+="Slice Start = "+this.slice_start+"\n",e+="Slice End = "+this.slice_end+"\n",e+='Description: "'+this.description+'"\n',e+='Auxiliary File: "'+this.aux_file+'"\n',e+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+")\n",e+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+")\n",e+="Quaternion Parameters:  b = "+t(this.quatern_b)+"  c = "+t(this.quatern_c)+"  d = "+t(this.quatern_d)+"\n",e+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+"\n",e+="S-Form Parameters X: "+t(this.affine[0][0])+", "+t(this.affine[0][1])+", "+t(this.affine[0][2])+", "+t(this.affine[0][3])+"\n",e+="S-Form Parameters Y: "+t(this.affine[1][0])+", "+t(this.affine[1][1])+", "+t(this.affine[1][2])+", "+t(this.affine[1][3])+"\n",e+="S-Form Parameters Z: "+t(this.affine[2][0])+", "+t(this.affine[2][1])+", "+t(this.affine[2][2])+", "+t(this.affine[2][3])+"\n",e+="Slice Code = "+this.slice_code+"\n",e+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(s.a.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(s.a.TEMPORAL_UNITS_MASK&this.xyzt_units)+")\n",e+="Intent Code = "+this.intent_code+"\n",e+='Intent Name: "'+this.intent_name+'"\n',e+="Dim Info = "+this.dim_info+"\n"}getExtensionLocation=function(){return a.MAGIC_COOKIE+4};getExtensionSize=s.a.prototype.getExtensionSize;getExtensionCode=s.a.prototype.getExtensionCode;addExtension=s.a.prototype.addExtension;removeExtension=s.a.prototype.removeExtension;getDatatypeCodeString=s.a.prototype.getDatatypeCodeString;getTransformCodeString=s.a.prototype.getTransformCodeString;getUnitsCodeString=s.a.prototype.getUnitsCodeString;getQformMat=s.a.prototype.getQformMat;convertNiftiQFormToNiftiSForm=s.a.prototype.convertNiftiQFormToNiftiSForm;convertNiftiSFormToNEMA=s.a.prototype.convertNiftiSFormToNEMA;nifti_mat33_mul=s.a.prototype.nifti_mat33_mul;nifti_mat33_determ=s.a.prototype.nifti_mat33_determ;toArrayBuffer(t=!1){let e=544;if(t)for(let r of this.extensions)e+=r.esize;let i=new Uint8Array(e),n=new DataView(i.buffer);n.setInt32(0,540,this.littleEndian),i.set((new TextEncoder).encode(this.magic),4),n.setInt16(12,this.datatypeCode,this.littleEndian),n.setInt16(14,this.numBitsPerVoxel,this.littleEndian);for(let r=0;r<8;r++)n.setBigInt64(16+8*r,BigInt(this.dims[r]),this.littleEndian);n.setFloat64(80,this.intent_p1,this.littleEndian),n.setFloat64(88,this.intent_p2,this.littleEndian),n.setFloat64(96,this.intent_p3,this.littleEndian);for(let r=0;r<8;r++)n.setFloat64(104+8*r,this.pixDims[r],this.littleEndian);n.setBigInt64(168,BigInt(this.vox_offset),this.littleEndian),n.setFloat64(176,this.scl_slope,this.littleEndian),n.setFloat64(184,this.scl_inter,this.littleEndian),n.setFloat64(192,this.cal_max,this.littleEndian),n.setFloat64(200,this.cal_min,this.littleEndian),n.setFloat64(208,this.slice_duration,this.littleEndian),n.setFloat64(216,this.toffset,this.littleEndian),n.setBigInt64(224,BigInt(this.slice_start),this.littleEndian),n.setBigInt64(232,BigInt(this.slice_end),this.littleEndian),i.set((new TextEncoder).encode(this.description),240),i.set((new TextEncoder).encode(this.aux_file),320),n.setInt32(344,this.qform_code,this.littleEndian),n.setInt32(348,this.sform_code,this.littleEndian),n.setFloat64(352,this.quatern_b,this.littleEndian),n.setFloat64(360,this.quatern_c,this.littleEndian),n.setFloat64(368,this.quatern_d,this.littleEndian),n.setFloat64(376,this.qoffset_x,this.littleEndian),n.setFloat64(384,this.qoffset_y,this.littleEndian),n.setFloat64(392,this.qoffset_z,this.littleEndian);const s=this.affine.flat();for(let r=0;r<12;r++)n.setFloat64(400+8*r,s[r],this.littleEndian);if(n.setInt32(496,this.slice_code,this.littleEndian),n.setInt32(500,this.xyzt_units,this.littleEndian),n.setInt32(504,this.intent_code,this.littleEndian),i.set((new TextEncoder).encode(this.intent_name),508),n.setUint8(524,this.dim_info),t){i.set(Uint8Array.from([1,0,0,0]),540);let t=this.getExtensionLocation();for(const e of this.extensions)n.setInt32(t,e.esize,e.littleEndian),n.setInt32(t+4,e.ecode,e.littleEndian),i.set(new Uint8Array(e.edata),t+8),t+=e.esize}else i.set(new Uint8Array(4).fill(0),540);return i.buffer}}function o(t,e=!1){var i,n,r,a;return!(t.byteLength<s.a.STANDARD_HEADER_SIZE)&&((i=new DataView(t))&&(n=i.getUint8(s.a.MAGIC_NUMBER_LOCATION)),r=i.getUint8(s.a.MAGIC_NUMBER_LOCATION+1),a=i.getUint8(s.a.MAGIC_NUMBER_LOCATION+2),!(!e||n!==s.a.MAGIC_NUMBER2[0]||r!==s.a.MAGIC_NUMBER2[1]||a!==s.a.MAGIC_NUMBER2[2])||!(n!==s.a.MAGIC_NUMBER[0]||r!==s.a.MAGIC_NUMBER[1]||a!==s.a.MAGIC_NUMBER[2]))}function h(t,e=!1){var i,n,r,o;return!(t.byteLength<s.a.STANDARD_HEADER_SIZE)&&(n=(i=new DataView(t)).getUint8(a.MAGIC_NUMBER_LOCATION),r=i.getUint8(a.MAGIC_NUMBER_LOCATION+1),o=i.getUint8(a.MAGIC_NUMBER_LOCATION+2),!(!e||n!==a.MAGIC_NUMBER2[0]||r!==a.MAGIC_NUMBER2[1]||o!==a.MAGIC_NUMBER2[2])||!(n!==a.MAGIC_NUMBER[0]||r!==a.MAGIC_NUMBER[1]||o!==a.MAGIC_NUMBER[2]))}function l(t){var e,i,n;if(t){if(i=(e=new DataView(t)).getUint8(0),n=e.getUint8(1),i===r.A.GUNZIP_MAGIC_COOKIE1)return!0;if(n===r.A.GUNZIP_MAGIC_COOKIE2)return!0}return!1}async function f(t){const e=new Uint8Array(t),i=31===e[0]&&139===e[1]&&8===e[2]?"gzip":120!==e[0]||1!==e[1]&&94!==e[1]&&156!==e[1]&&218!==e[1]?"deflate-raw":"deflate",n=new DecompressionStream(i),s=n.writable.getWriter();s.write(e).catch(console.error);const r=s.close().catch(console.error),a=new Response(n.readable),o=await a.arrayBuffer();return await r,o}async function c(t,e=1/0){const i=new Uint8Array(t),n=(t=>31===t[0]&&139===t[1]&&8===t[2]?"gzip":120===t[0]&&[1,94,156,218].includes(t[1])?"deflate":"deflate-raw")(i),s=new DecompressionStream(n),r=new TransformStream({transform(t,e){e.enqueue(t)},flush(t){t.terminate()}}),{readable:a,writable:o}=s,h=o.getWriter(),l=a.pipeThrough(r).getReader();h.write(i).catch((t=>{t instanceof Error&&"AbortError"===t.name||console.error("Error during write:",t)}));const f=[];let c=0;try{for(;c<e;){const{done:t,value:i}=await l.read();if(t)break;const n=e-c,s=i.subarray(0,Math.min(i.length,n));if(f.push(s),c+=s.length,c>=e){await Promise.all([l.cancel().catch((()=>{})),h.abort().catch((()=>{}))]);break}}}catch(u){u instanceof Error&&"AbortError"===u.name||console.error("Error during decompression:",u)}finally{await Promise.allSettled([l.cancel().catch((()=>{})),h.close().catch((()=>{}))])}return 1===f.length?f[0].buffer:f.reduce(((t,e)=>{const i=new Uint8Array(t.byteLength+e.byteLength);return i.set(new Uint8Array(t),0),i.set(e,t.byteLength),i.buffer}),new ArrayBuffer(0))}function u(t,e=!1){let i=null;if(l(t)&&(t=function(t){return(0,n.Rq)(new Uint8Array(t)).buffer}(t)),o(t,e)?i=new s.a:h(t,e)&&(i=new a),!i)throw new Error("That file does not appear to be NIFTI!");return i.readHeader(t),i}async function d(t,e=!1){if(!l(t))return u(t,e);let i=null,n=await c(t,540),o=!0,h=!0;var f=new DataView(n);const d=f.getInt32(0,!0),_=f.getInt32(0,!1);if(348===d);else if(348===_)o=!1;else if(540===d)h=!1;else{if(540!==_)throw new Error("That file does not appear to be NIFTI!");h=!1,o=!1}let A=Math.round(f.getFloat32(108,o));return a&&(A=r.A.getUint64At(f,168,o)),A>n.byteLength&&(n=await c(t,A)),i=h?new s.a:new a,i.readHeader(n),i}function _(t,e){var i=t.vox_offset,n=1,s=1;t.dims[4]&&(n=t.dims[4]),t.dims[5]&&(s=t.dims[5]);var r=t.dims[1]*t.dims[2]*t.dims[3]*n*s*(t.numBitsPerVoxel/8);return e.slice(i,i+r)}},8553:(t,e,i)=>{"use strict";i.d(e,{Ei:()=>u,Wm:()=>h,ff:()=>c,lC:()=>l,qv:()=>a,rK:()=>f,sO:()=>r,tV:()=>n,uT:()=>s,vH:()=>o});const n=-1,s=0,r=1,a=2,o=3,h=4,l=5,f=6,c=7,u=8},9095:(t,e,i)=>{"use strict";i.d(e,{$0:()=>g,B8:()=>f,C:()=>a,D_:()=>h,Ny:()=>m,Qr:()=>A,Tl:()=>u,eL:()=>_,fA:()=>o,hs:()=>d,lK:()=>p,lw:()=>c,mg:()=>l,o8:()=>r,v3:()=>E,vt:()=>s});var n=i(3172);function s(){var t=new n.tb(16);return n.tb!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function r(t){var e=new n.tb(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function o(t,e,i,s,r,a,o,h,l,f,c,u,d,_,A,g){var E=new n.tb(16);return E[0]=t,E[1]=e,E[2]=i,E[3]=s,E[4]=r,E[5]=a,E[6]=o,E[7]=h,E[8]=l,E[9]=f,E[10]=c,E[11]=u,E[12]=d,E[13]=_,E[14]=A,E[15]=g,E}function h(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function l(t,e){if(t===e){var i=e[1],n=e[2],s=e[3],r=e[6],a=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=r,t[11]=e[14],t[12]=s,t[13]=a,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function f(t,e){var i=e[0],n=e[1],s=e[2],r=e[3],a=e[4],o=e[5],h=e[6],l=e[7],f=e[8],c=e[9],u=e[10],d=e[11],_=e[12],A=e[13],g=e[14],E=e[15],m=i*o-n*a,p=i*h-s*a,I=i*l-r*a,x=n*h-s*o,y=n*l-r*o,v=s*l-r*h,b=f*A-c*_,M=f*g-u*_,S=f*E-d*_,T=c*g-u*A,w=c*E-d*A,C=u*E-d*g,N=m*C-p*w+I*T+x*S-y*M+v*b;return N?(N=1/N,t[0]=(o*C-h*w+l*T)*N,t[1]=(s*w-n*C-r*T)*N,t[2]=(A*v-g*y+E*x)*N,t[3]=(u*y-c*v-d*x)*N,t[4]=(h*S-a*C-l*M)*N,t[5]=(i*C-s*S+r*M)*N,t[6]=(g*I-_*v-E*p)*N,t[7]=(f*v-u*I+d*p)*N,t[8]=(a*w-o*S+l*b)*N,t[9]=(n*S-i*w-r*b)*N,t[10]=(_*y-A*I+E*m)*N,t[11]=(c*I-f*y-d*m)*N,t[12]=(o*M-a*T-h*b)*N,t[13]=(i*T-n*M+s*b)*N,t[14]=(A*p-_*x-g*m)*N,t[15]=(f*x-c*p+u*m)*N,t):null}function c(t,e,i){var n=e[0],s=e[1],r=e[2],a=e[3],o=e[4],h=e[5],l=e[6],f=e[7],c=e[8],u=e[9],d=e[10],_=e[11],A=e[12],g=e[13],E=e[14],m=e[15],p=i[0],I=i[1],x=i[2],y=i[3];return t[0]=p*n+I*o+x*c+y*A,t[1]=p*s+I*h+x*u+y*g,t[2]=p*r+I*l+x*d+y*E,t[3]=p*a+I*f+x*_+y*m,p=i[4],I=i[5],x=i[6],y=i[7],t[4]=p*n+I*o+x*c+y*A,t[5]=p*s+I*h+x*u+y*g,t[6]=p*r+I*l+x*d+y*E,t[7]=p*a+I*f+x*_+y*m,p=i[8],I=i[9],x=i[10],y=i[11],t[8]=p*n+I*o+x*c+y*A,t[9]=p*s+I*h+x*u+y*g,t[10]=p*r+I*l+x*d+y*E,t[11]=p*a+I*f+x*_+y*m,p=i[12],I=i[13],x=i[14],y=i[15],t[12]=p*n+I*o+x*c+y*A,t[13]=p*s+I*h+x*u+y*g,t[14]=p*r+I*l+x*d+y*E,t[15]=p*a+I*f+x*_+y*m,t}function u(t,e,i){var n,s,r,a,o,h,l,f,c,u,d,_,A=i[0],g=i[1],E=i[2];return e===t?(t[12]=e[0]*A+e[4]*g+e[8]*E+e[12],t[13]=e[1]*A+e[5]*g+e[9]*E+e[13],t[14]=e[2]*A+e[6]*g+e[10]*E+e[14],t[15]=e[3]*A+e[7]*g+e[11]*E+e[15]):(n=e[0],s=e[1],r=e[2],a=e[3],o=e[4],h=e[5],l=e[6],f=e[7],c=e[8],u=e[9],d=e[10],_=e[11],t[0]=n,t[1]=s,t[2]=r,t[3]=a,t[4]=o,t[5]=h,t[6]=l,t[7]=f,t[8]=c,t[9]=u,t[10]=d,t[11]=_,t[12]=n*A+o*g+c*E+e[12],t[13]=s*A+h*g+u*E+e[13],t[14]=r*A+l*g+d*E+e[14],t[15]=a*A+f*g+_*E+e[15]),t}function d(t,e,i){var n=i[0],s=i[1],r=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function _(t,e,i){var n=Math.sin(i),s=Math.cos(i),r=e[4],a=e[5],o=e[6],h=e[7],l=e[8],f=e[9],c=e[10],u=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=r*s+l*n,t[5]=a*s+f*n,t[6]=o*s+c*n,t[7]=h*s+u*n,t[8]=l*s-r*n,t[9]=f*s-a*n,t[10]=c*s-o*n,t[11]=u*s-h*n,t}function A(t,e,i){var n=Math.sin(i),s=Math.cos(i),r=e[0],a=e[1],o=e[2],h=e[3],l=e[4],f=e[5],c=e[6],u=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*s+l*n,t[1]=a*s+f*n,t[2]=o*s+c*n,t[3]=h*s+u*n,t[4]=l*s-r*n,t[5]=f*s-a*n,t[6]=c*s-o*n,t[7]=u*s-h*n,t}function g(t,e,i){var s,r,a,o=i[0],h=i[1],l=i[2],f=Math.hypot(o,h,l);return f<n.p8?null:(o*=f=1/f,h*=f,l*=f,s=Math.sin(e),a=1-(r=Math.cos(e)),t[0]=o*o*a+r,t[1]=h*o*a+l*s,t[2]=l*o*a-h*s,t[3]=0,t[4]=o*h*a-l*s,t[5]=h*h*a+r,t[6]=l*h*a+o*s,t[7]=0,t[8]=o*l*a+h*s,t[9]=h*l*a-o*s,t[10]=l*l*a+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}var E=function(t,e,i,n,s,r,a){var o=1/(e-i),h=1/(n-s),l=1/(r-a);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+i)*o,t[13]=(s+n)*h,t[14]=(a+r)*l,t[15]=1,t};function m(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t}var p=c},9302:(t,e,i)=>{"use strict";i.d(e,{Rq:()=>G,as:()=>R});var n=Uint8Array,s=Uint16Array,r=Int32Array,a=new n([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),o=new n([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),h=new n([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l=function(t,e){for(var i=new s(31),n=0;n<31;++n)i[n]=e+=1<<t[n-1];var a=new r(i[30]);for(n=1;n<30;++n)for(var o=i[n];o<i[n+1];++o)a[o]=o-i[n]<<5|n;return{b:i,r:a}},f=l(a,2),c=f.b,u=f.r;c[28]=258,u[258]=28;for(var d=l(o,0),_=d.b,A=(d.r,new s(32768)),g=0;g<32768;++g){var E=(43690&g)>>1|(21845&g)<<1;E=(61680&(E=(52428&E)>>2|(13107&E)<<2))>>4|(3855&E)<<4,A[g]=((65280&E)>>8|(255&E)<<8)>>1}var m=function(t,e,i){for(var n=t.length,r=0,a=new s(e);r<n;++r)t[r]&&++a[t[r]-1];var o,h=new s(e);for(r=1;r<e;++r)h[r]=h[r-1]+a[r-1]<<1;if(i){o=new s(1<<e);var l=15-e;for(r=0;r<n;++r)if(t[r])for(var f=r<<4|t[r],c=e-t[r],u=h[t[r]-1]++<<c,d=u|(1<<c)-1;u<=d;++u)o[A[u]>>l]=f}else for(o=new s(n),r=0;r<n;++r)t[r]&&(o[r]=A[h[t[r]-1]++]>>15-t[r]);return o},p=new n(288);for(g=0;g<144;++g)p[g]=8;for(g=144;g<256;++g)p[g]=9;for(g=256;g<280;++g)p[g]=7;for(g=280;g<288;++g)p[g]=8;var I=new n(32);for(g=0;g<32;++g)I[g]=5;var x=m(p,9,1),y=m(I,5,1),v=function(t){for(var e=t[0],i=1;i<t.length;++i)t[i]>e&&(e=t[i]);return e},b=function(t,e,i){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(7&e)&i},M=function(t,e){var i=e/8|0;return(t[i]|t[i+1]<<8|t[i+2]<<16)>>(7&e)},S=function(t){return(t+7)/8|0},T=function(t,e,i){return(null==e||e<0)&&(e=0),(null==i||i>t.length)&&(i=t.length),new n(t.subarray(e,i))},w=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],C=function(t,e,i){var n=new Error(e||w[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,C),!i)throw n;return n},N=function(t,e,i,s){var r=t.length,l=s?s.length:0;if(!r||e.f&&!e.l)return i||new n(0);var f=!i,u=f||2!=e.i,d=e.i;f&&(i=new n(3*r));var A=function(t){var e=i.length;if(t>e){var s=new n(Math.max(2*e,t));s.set(i),i=s}},g=e.f||0,E=e.p||0,p=e.b||0,I=e.l,w=e.d,N=e.m,F=e.n,U=8*r;do{if(!I){g=b(t,E,1);var q=b(t,E+1,3);if(E+=3,!q){var D=t[(K=S(E)+4)-4]|t[K-3]<<8,B=K+D;if(B>r){d&&C(0);break}u&&A(p+D),i.set(t.subarray(K,B),p),e.b=p+=D,e.p=E=8*B,e.f=g;continue}if(1==q)I=x,w=y,N=9,F=5;else if(2==q){var O=b(t,E,31)+257,R=b(t,E+10,15)+4,P=O+b(t,E+5,31)+1;E+=14;for(var z=new n(P),G=new n(19),L=0;L<R;++L)G[h[L]]=b(t,E+3*L,7);E+=3*R;var k=v(G),Y=(1<<k)-1,V=m(G,k,1);for(L=0;L<P;){var K,X=V[b(t,E,Y)];if(E+=15&X,(K=X>>4)<16)z[L++]=K;else{var H=0,Z=0;for(16==K?(Z=3+b(t,E,3),E+=2,H=z[L-1]):17==K?(Z=3+b(t,E,7),E+=3):18==K&&(Z=11+b(t,E,127),E+=7);Z--;)z[L++]=H}}var Q=z.subarray(0,O),j=z.subarray(O);N=v(Q),F=v(j),I=m(Q,N,1),w=m(j,F,1)}else C(1);if(E>U){d&&C(0);break}}u&&A(p+131072);for(var W=(1<<N)-1,J=(1<<F)-1,$=E;;$=E){var tt=(H=I[M(t,E)&W])>>4;if((E+=15&H)>U){d&&C(0);break}if(H||C(2),tt<256)i[p++]=tt;else{if(256==tt){$=E,I=null;break}var et=tt-254;if(tt>264){var it=a[L=tt-257];et=b(t,E,(1<<it)-1)+c[L],E+=it}var nt=w[M(t,E)&J],st=nt>>4;nt||C(3),E+=15&nt;j=_[st];if(st>3){it=o[st];j+=M(t,E)&(1<<it)-1,E+=it}if(E>U){d&&C(0);break}u&&A(p+131072);var rt=p+et;if(p<j){var at=l-j,ot=Math.min(j,rt);for(at+p<0&&C(3);p<ot;++p)i[p]=s[at+p]}for(;p<rt;++p)i[p]=i[p-j]}}e.l=I,e.p=$,e.b=p,e.f=g,I&&(g=1,e.m=N,e.d=w,e.n=F)}while(!g);return p!=i.length&&f?T(i,0,p):i.subarray(0,p)},F=new n(0),U=function(t){31==t[0]&&139==t[1]&&8==t[2]||C(6,"invalid gzip data");var e=t[3],i=10;4&e&&(i+=2+(t[10]|t[11]<<8));for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[i++]);return i+(2&e)},q=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},D=function(t,e){return(8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31)&&C(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&C(6,"invalid zlib data: "+(32&t[1]?"need":"unexpected")+" dictionary"),2+(t[1]>>3&4)};var B=function(){function t(t,e){"function"==typeof t&&(e=t,t={}),this.ondata=e;var i=t&&t.dictionary&&t.dictionary.subarray(-32768);this.s={i:0,b:i?i.length:0},this.o=new n(32768),this.p=new n(0),i&&this.o.set(i)}return t.prototype.e=function(t){if(this.ondata||C(5),this.d&&C(4),this.p.length){if(t.length){var e=new n(this.p.length+t.length);e.set(this.p),e.set(t,this.p.length),this.p=e}}else this.p=t},t.prototype.c=function(t){this.s.i=+(this.d=t||!1);var e=this.s.b,i=N(this.p,this.s,this.o);this.ondata(T(i,e,this.s.b),this.d),this.o=T(i,this.s.b-32768),this.s.b=this.o.length,this.p=T(this.p,this.s.p/8|0),this.s.p&=7},t.prototype.push=function(t,e){this.e(t),this.c(e)},t}();function O(t,e){return N(t,{i:2},e&&e.out,e&&e.dictionary)}var R=function(){function t(t,e){this.v=1,this.r=0,B.call(this,t,e)}return t.prototype.push=function(t,e){if(B.prototype.e.call(this,t),this.r+=t.length,this.v){var i=this.p.subarray(this.v-1),s=i.length>3?U(i):4;if(s>i.length){if(!e)return}else this.v>1&&this.onmember&&this.onmember(this.r-i.length);this.p=i.subarray(s),this.v=0}B.prototype.c.call(this,e),!this.s.f||this.s.l||e||(this.v=S(this.s.p)+9,this.s={i:0},this.o=new n(0),this.push(new n(0),e))},t}();function P(t,e){var i=U(t);return i+8>t.length&&C(6,"invalid gzip data"),N(t.subarray(i,-8),{i:2},e&&e.out||new n(q(t)),e&&e.dictionary)}function z(t,e){return N(t.subarray(D(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function G(t,e){return 31==t[0]&&139==t[1]&&8==t[2]?P(t,e):8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31?O(t,e):z(t,e)}var L="undefined"!=typeof TextDecoder&&new TextDecoder;try{L.decode(F,{stream:!0})}catch(k){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout},9659:(t,e,i)=>{"use strict";i.d(e,{v4:()=>a});for(var n,s=256,r=[];s--;)r[s]=(s+256).toString(16).substring(1);function a(){var t,e=0,i="";if(!n||s+16>256){for(n=Array(e=256);e--;)n[e]=256*Math.random()|0;e=s=0}for(;e<16;e++)t=n[s+e],i+=6==e?r[15&t|64]:8==e?r[63&t|128]:r[t],1&e&&e>1&&e<11&&(i+="-");return s++,i}}}]);